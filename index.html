<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dịch Vụ Du Lịch Cali</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #ffcc00, #ff6f61);
            color: #333;
            min-height: 100vh;
        }
        .container {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        h1 {
            text-align: center;
            color: #d35400;
        }
        .contact-info {
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.1em;
        }
        .lang-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 10px;
            background: #d35400;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        select, input, button {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 1em;
            box-sizing: border-box;
        }
        button {
            background: #d35400;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background: #e67e22;
        }
        .cost-estimate {
            margin-top: 20px;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 5px;
        }
        .hidden {
            display: none;
        }
        input:disabled {
            background: #f0f0f0;
            cursor: not-allowed;
        }
        @media (max-width: 600px) {
            .container {
                margin: 10px;
                padding: 15px;
            }
            select, input, button {
                font-size: 0.9em;
            }
            .lang-toggle {
                top: 10px;
                right: 10px;
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <button class="lang-toggle" onclick="toggleLanguage()">English</button>
    <div class="container">
        <h1>Dịch Vụ Du Lịch Cali</h1>
        <div class="contact-info">
            Duy Hoa, Phone: <a href="tel:714-227-6007">714-227-6007</a>, 
            Email: <a href="mailto:dulichcali21@gmail.com">dulichcali21@gmail.com</a>
        </div>

        <label for="service-type">Loại Dịch Vụ:</label>
        <select id="service-type" onchange="toggleService()">
            <option value="travel">Gói Du Lịch</option>
            <option value="airport">Dịch Vụ Sân Bay</option>
        </select>

        <!-- Travel Package Form -->
        <form id="travel-form" action="https://formspree.io/f/xeokgbpo" method="POST" class="hidden">
            <label for="name">Họ Tên:</label>
            <input type="text" id="name" name="name" required>
            <label for="phone">Số Điện Thoại:</label>
            <input type="tel" id="phone" name="phone" required>
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" required>
            <label for="pickup-date">Ngày Đón:</label>
            <input type="date" id="pickup-date" name="pickup_date" required>
            <label for="pickup-time">Giờ Đón:</label>
            <input type="time" id="pickup-time" name="pickup_time" required>
            <label for="days">Số Ngày:</label>
            <input type="number" id="days" name="days" min="1" value="1" oninput="updateCost()">
            <label for="package">Gói Du Lịch:</label>
            <select id="package" name="package" onchange="updateDestinations()">
                <option value="custom">Tùy Chọn Điểm Đến</option>
                <option value="disneyland">Disneyland Adventure</option>
                <option value="sandiego">San Diego Family Fun</option>
                <option value="universal">Universal Hollywood</option>
                <option value="national">National Parks Explorer</option>
                <option value="city">City Getaway</option>
            </select>
            <label for="destinations">Điểm Đến:</label>
            <select id="destinations" name="destinations" multiple onchange="updateTravelerInput(); updateCost(); toggleMeals()">
                <option value="Disneyland">Disneyland</option>
                <option value="California Adventure">California Adventure</option>
                <option value="Universal Studios">Universal Studios</option>
                <option value="San Diego Zoo">San Diego Zoo</option>
                <option value="SeaWorld">SeaWorld</option>
                <option value="LegoLand">LegoLand</option>
                <option value="Las Vegas">Las Vegas</option>
                <option value="Grand Canyon">Grand Canyon</option>
                <option value="San Francisco">San Francisco</option>
                <option value="Yosemite">Yosemite</option>
                <option value="Lake Tahoe">Lake Tahoe</option>
                <option value="Reno">Reno</option>
                <option value="Silicon Valley">Silicon Valley</option>
            </select>
            <label for="ticket-type">Loại Vé (Disneyland/Universal):</label>
            <select id="ticket-type" name="ticket_type" onchange="updateCost()">
                <option value="regular">Thường</option>
                <option value="express">Express</option>
                <option value="vip">VIP</option>
            </select>
            <label for="adults">Người Lớn (Disneyland/Universal):</label>
            <input type="number" id="adults" name="adults" min="0" max="12" value="0" oninput="updateTravelerInput(); updateCost()">
            <label for="kids">Trẻ Em (Disneyland/Universal):</label>
            <input type="number" id="kids" name="kids" min="0" max="12" value="0" oninput="updateTravelerInput(); updateCost()">
            <label for="travelers">Số Hành Khách (Khác):</label>
            <input type="number" id="travelers" name="travelers" min="1" max="12" value="1" oninput="updateCost()">
            <label for="lodging">Lưu Trú:</label>
            <select id="lodging" name="lodging" onchange="toggleLodging(); updateCost()">
                <option value="none">Không Lưu Trú</option>
                <option value="airbnb">Airbnb</option>
                <option value="hotel">Khách Sạn</option>
            </select>
            <div id="dropoff-address-div" class="hidden">
                <label for="dropoff-address">Địa Chỉ Đưa Đón:</label>
                <input type="text" id="dropoff-address" name="dropoff_address" oninput="updateCost()">
            </div>
            <label for="airport-pickup">Đón Sân Bay:</label>
            <select id="airport-pickup" name="airport_pickup" onchange="updateCost()">
                <option value="none">Không</option>
                <option value="SNA">SNA</option>
                <option value="LAX">LAX</option>
                <option value="LGB">LGB</option>
            </select>
            <div id="meals-div" class="hidden">
                <label><input type="checkbox" id="meals" name="meals" onchange="updateCost()"> Bữa Ăn Nhà Nấu ($35/ngày/người)</label>
            </div>
            <div class="cost-estimate">
                <h3>Ước Tính Chi Phí</h3>
                <p>Vận Chuyển: $<span id="transport-cost">0</span></p>
                <p>Vé Vào Cửa: $<span id="admission-cost">0</span></p>
                <p>Lưu Trú: $<span id="lodging-cost">0</span></p>
                <p>Bữa Ăn: $<span id="meals-cost">0</span></p>
                <p>Tổng Cộng: $<span id="total-cost">0</span></p>
            </div>
            <div id="paypal-button"></div>
            <input type="hidden" id="form-details" name="details">
        </form>

        <!-- Airport Service Form -->
        <form id="airport-form" action="https://formspree.io/f/xeokgbpo" method="POST">
            <label for="name-airport">Họ Tên:</label>
            <input type="text" id="name-airport" name="name" required>
            <label for="phone-airport">Số Điện Thoại:</label>
            <input type="tel" id="phone-airport" name="phone" required>
            <label for="date">Ngày:</label>
            <input type="date" id="date" name="date" required>
            <label for="time">Giờ:</label>
            <input type="time" id="time" name="time" required>
            <label for="airport-service-type">Loại Dịch Vụ:</label>
            <select id="airport-service-type" name="service_type" onchange="toggleAirportFields(); updateCost()">
                <option value="pickup">Đón Tại Sân Bay</option>
                <option value="dropoff">Đưa Ra Sân Bay</option>
            </select>
            <label for="airport">Sân Bay:</label>
            <select id="airport" name="airport" onchange="updateCost()">
                <option value="SNA">SNA</option>
                <option value="LAX">LAX</option>
                <option value="LGB">LGB</option>
            </select>
            <div id="pickup-address-div" class="hidden">
                <label for="pickup-address">Địa Chỉ Đón:</label>
                <input type="text" id="pickup-address" name="pickup_address" oninput="updateCost()">
            </div>
            <div id="dropoff-address-div-airport">
                <label for="dropoff-address-airport">Địa Chỉ Đưa:</label>
                <input type="text" id="dropoff-address-airport" name="dropoff_address" oninput="updateCost()">
            </div>
            <label for="travelers-airport">Số Hành Khách:</label>
            <input type="number" id="travelers-airport" name="travelers" min="1" max="12" value="1" oninput="updateCost()">
            <div class="cost-estimate">
                <h3>Ước Tính Chi Phí</h3>
                <p>Vận Chuyển: $<span id="transport-cost-airport">0</span></p>
                <p>Tổng Cộng: $<span id="total-cost-airport">0</span></p>
            </div>
            <button type="submit">Thanh Toán Sau</button>
            <input type="hidden" id="form-details-airport" name="details">
        </form>
    </div>

    <script src="https://www.paypal.com/sdk/js?client-id=YOUR_PAYPAL_CLIENT_ID&currency=USD"></script>
    <script>
        const translations = {
            vi: {
                title: "Dịch Vụ Du Lịch Cali",
                serviceType: "Loại Dịch Vụ:",
                travel: "Gói Du Lịch",
                airport: "Dịch Vụ Sân Bay",
                name: "Họ Tên:",
                phone: "Số Điện Thoại:",
                email: "Email:",
                pickupDate: "Ngày Đón:",
                pickupTime: "Giờ Đón:",
                days: "Số Ngày:",
                package: "Gói Du Lịch:",
                destinations: "Điểm Đến:",
                ticketType: "Loại Vé (Disneyland/Universal):",
                adults: "Người Lớn (Disneyland/Universal):",
                kids: "Trẻ Em (Disneyland/Universal):",
                travelers: "Số Hành Khách (Khác):",
                lodging: "Lưu Trú:",
                dropoffAddress: "Địa Chỉ Đưa Đón:",
                airportPickup: "Đón Sân Bay:",
                meals: "Bữa Ăn Nhà Nấu ($35/ngày/người)",
                costEstimate: "Ước Tính Chi Phí",
                transport: "Vận Chuyển:",
                admission: "Vé Vào Cửa:",
                lodgingCost: "Lưu Trú:",
                mealsCost: "Bữa Ăn:",
                total: "Tổng Cộng:",
                airportServiceType: "Loại Dịch Vụ:",
                airport: "Sân Bay:",
                pickupAddress: "Địa Chỉ Đón:",
                dropoffAddressAirport: "Địa Chỉ Đưa:",
                travelersAirport: "Số Hành Khách:",
                date: "Ngày:",
                time: "Giờ:",
                payLater: "Thanh Toán Sau",
                payPaypal: "Thanh Toán qua PayPal",
                langButton: "English"
            },
            en: {
                title: "Cali Travel Services",
                serviceType: "Service Type:",
                travel: "Travel Package",
                airport: "Airport Service",
                name: "Full Name:",
                phone: "Phone Number:",
                email: "Email:",
                pickupDate: "Pickup Date:",
                pickupTime: "Pickup Time:",
                days: "Number of Days:",
                package: "Travel Package:",
                destinations: "Destinations:",
                ticketType: "Ticket Type (Disneyland/Universal):",
                adults: "Adults (Disneyland/Universal):",
                kids: "Kids (Disneyland/Universal):",
                travelers: "Number of Travelers (Other):",
                lodging: "Lodging:",
                dropoffAddress: "Drop-off Address:",
                airportPickup: "Airport Pickup:",
                meals: "Home-Cooked Meals ($35/day/person)",
                costEstimate: "Cost Estimate",
                transport: "Transportation:",
                admission: "Admission Tickets:",
                lodgingCost: "Lodging:",
                mealsCost: "Meals:",
                total: "Total:",
                airportServiceType: "Service Type:",
                airport: "Airport:",
                pickupAddress: "Pickup Address:",
                dropoffAddressAirport: "Drop-off Address:",
                travelersAirport: "Number of Travelers:",
                date: "Date:",
                time: "Time:",
                payLater: "Pay Later",
                payPaypal: "Pay via PayPal",
                langButton: "Tiếng Việt"
            }
        };

        let currentLang = 'vi';

        function toggleLanguage() {
            currentLang = currentLang === 'vi' ? 'en' : 'vi';
            document.querySelector('.lang-toggle').textContent = translations[currentLang].langButton;
            document.querySelector('h1').textContent = translations[currentLang].title;
            document.querySelectorAll('label, button, .cost-estimate h3, .cost-estimate p').forEach(el => {
                const text = el.textContent.trim();
                for (let key in translations[currentLang]) {
                    if (text.includes(translations[currentLang][key]) || text === translations[currentLang][key]) {
                        el.textContent = translations[currentLang][key];
                    }
                }
            });
            document.querySelector('#service-type option[value="travel"]').textContent = translations[currentLang].travel;
            document.querySelector('#service-type option[value="airport"]').textContent = translations[currentLang].airport;
            document.querySelector('#airport-form button').textContent = translations[currentLang].payLater;
            updateCost();
        }

        function toggleService() {
            const service = document.getElementById('service-type').value;
            document.getElementById('travel-form').classList.toggle('hidden', service !== 'travel');
            document.getElementById('airport-form').classList.toggle('hidden', service !== 'airport');
            updateCost();
        }

        function updateDestinations() {
            const package = document.getElementById('package').value;
            const destinations = document.getElementById('destinations');
            destinations.innerHTML = '';
            const allDestinations = [
                'Disneyland', 'California Adventure', 'Universal Studios', 'San Diego Zoo',
                'SeaWorld', 'LegoLand', 'Las Vegas', 'Grand Canyon', 'San Francisco',
                'Yosemite', 'Lake Tahoe', 'Reno', 'Silicon Valley'
            ];
            const packageDestinations = {
                disneyland: ['Disneyland', 'California Adventure'],
                sandiego: ['San Diego Zoo', 'SeaWorld', 'LegoLand'],
                universal: ['Universal Studios'],
                national: ['Grand Canyon', 'Yosemite'],
                city: ['Las Vegas', 'San Francisco', 'Reno']
            };
            const selected = package === 'custom' ? [] : packageDestinations[package] || [];
            allDestinations.forEach(dest => {
                const option = document.createElement('option');
                option.value = dest;
                option.textContent = dest;
                if (selected.includes(dest)) option.selected = true;
                destinations.appendChild(option);
            });
            updateTravelerInput();
            toggleMeals();
            updateCost();
        }

        function toggleLodging() {
            const lodging = document.getElementById('lodging').value;
            document.getElementById('dropoff-address-div').classList.toggle('hidden', lodging !== 'none');
            updateCost();
        }

        function toggleMeals() {
            const destinations = Array.from(document.getElementById('destinations').selectedOptions).map(opt => opt.value);
            const bayArea = ['San Francisco', 'Silicon Valley'];
            document.getElementById('meals-div').classList.toggle('hidden', !destinations.some(dest => bayArea.includes(dest)));
            updateCost();
        }

        function toggleAirportFields() {
            const type = document.getElementById('airport-service-type').value;
            document.getElementById('pickup-address-div').classList.toggle('hidden', type !== 'dropoff');
            document.getElementById('dropoff-address-div-airport').classList.toggle('hidden', type !== 'pickup');
            updateCost();
        }

        function updateTravelerInput() {
            const destinations = Array.from(document.getElementById('destinations').selectedOptions).map(opt => opt.value);
            const hasThemePark = destinations.some(dest => ['Disneyland', 'California Adventure', 'Universal Studios'].includes(dest));
            const travelersInput = document.getElementById('travelers');
            const adults = parseInt(document.getElementById('adults').value) || 0;
            const kids = parseInt(document.getElementById('kids').value) || 0;

            if (hasThemePark) {
                const totalTravelers = Math.max(1, Math.min(adults + kids, 12));
                travelersInput.value = totalTravelers;
                travelersInput.disabled = true;
            } else {
                travelersInput.disabled = false;
                if (!travelersInput.value) travelersInput.value = 1;
            }
            updateCost();
        }

        const distances = {
            'Disneyland': 60,
            'California Adventure': 60,
            'Universal Studios': 100,
            'San Diego Zoo': 190,
            'SeaWorld': 190,
            'LegoLand': 140,
            'Las Vegas': 540,
            'Grand Canyon': 960,
            'San Francisco': 860,
            'Yosemite': 700,
            'Lake Tahoe': 960,
            'Reno': 1000,
            'Silicon Valley': 760
        };

        const admissionFees = {
            'San Diego Zoo': 70,
            'SeaWorld': 90,
            'LegoLand': 100,
            'Las Vegas': 0,
            'Grand Canyon': 25,
            'San Francisco': 0,
            'Yosemite': 20,
            'Lake Tahoe': 0,
            'Reno': 0,
            'Silicon Valley': 20,
            'Disneyland': { regular: { adult: 150, kid: 100 }, vip: { adult: 300, kid: 200 }, express: { adult: 200, kid: 150 } },
            'California Adventure': { regular: { adult: 150, kid: 100 }, vip: { adult: 300, kid: 200 }, express: { adult: 200, kid: 150 } },
            'Universal Studios': { regular: { adult: 120, kid: 80 }, vip: { adult: 250, kid: 180 }, express: { adult: 180, kid: 130 } }
        };

        const lodgingCosts = {
            'Disneyland': { hotel: 200, airbnb: 150 },
            'California Adventure': { hotel: 200, airbnb: 150 },
            'Universal Studios': { hotel: 180, airbnb: 130 },
            'San Diego Zoo': { hotel: 160, airbnb: 120 },
            'SeaWorld': { hotel: 160, airbnb: 120 },
            'LegoLand': { hotel: 150, airbnb: 110 },
            'Las Vegas': { hotel: 120, airbnb: 100 },
            'Grand Canyon': { hotel: 140, airbnb: 110 },
            'San Francisco': { hotel: 250, airbnb: 200 },
            'Yosemite': { hotel: 180, airbnb: 140 },
            'Lake Tahoe': { hotel: 170, airbnb: 130 },
            'Reno': { hotel: 130, airbnb: 100 },
            'Silicon Valley': { hotel: 220, airbnb: 180 }
        };

        function getAirportCost(address, travelers) {
            if (!address || address.trim() === '') return 50; // Default for lodging
            const zip = address.match(/\d{5}/);
            const isOC = /926\d{2}|927\d{2}|928\d{2}|anaheim|irvine|huntington beach/i.test(address);
            let cost = 150;

            if (zip) {
                if (zip[0].startsWith('90')) cost = 100; // Los Angeles
                else if (zip[0].startsWith('908')) cost = 80; // Long Beach
                else if (isOC) cost = 50; // Orange County
            } else if (isOC) cost = 50;

            if (travelers <= 3) return cost;
            return cost * 1.2 + 30;
        }

        function updateCost() {
            const service = document.getElementById('service-type').value;
            if (service === 'travel') {
                const package = document.getElementById('package').value;
                const destinations = Array.from(document.getElementById('destinations').selectedOptions).map(opt => opt.value);
                const ticketType = document.getElementById('ticket-type').value;
                const adults = parseInt(document.getElementById('adults').value) || 0;
                const kids = parseInt(document.getElementById('kids').value) || 0;
                const travelers = parseInt(document.getElementById('travelers').value) || 1;
                const days = parseInt(document.getElementById('days').value) || 1;
                const lodging = document.getElementById('lodging').value;
                const dropoffAddress = document.getElementById('dropoff-address').value;
                const meals = document.getElementById('meals').checked;
                const airportPickup = document.getElementById('airport-pickup').value;

                const hasThemePark = destinations.some(dest => ['Disneyland', 'California Adventure', 'Universal Studios'].includes(dest));
                let totalTravelers = hasThemePark ? Math.max(1, Math.min(adults + kids, 12)) : Math.max(1, Math.min(travelers, 12));

                // Transportation Cost
                const maxDistance = Math.max(...destinations.map(dest => distances[dest] || 0), 0);
                let transportCost = maxDistance * 2.5 * days;
                if (totalTravelers > 3) transportCost = transportCost * 1.2 + 30 * days;

                // Airport Pickup Cost
                let airportCost = 0;
                if (airportPickup !== 'none') {
                    airportCost = getAirportCost(lodging === 'none' ? dropoffAddress : '', totalTravelers);
                }

                // Admission Cost
                let admissionCost = 0;
                destinations.forEach(dest => {
                    if (['Disneyland', 'California Adventure', 'Universal Studios'].includes(dest)) {
                        admissionCost += adults * admissionFees[dest][ticketType].adult + kids * admissionFees[dest][ticketType].kid;
                    } else {
                        admissionCost += totalTravelers * (admissionFees[dest] || 0);
                    }
                });

                // Lodging Cost
                let lodgingCost = 0;
                if (lodging !== 'none' && destinations.length > 0) {
                    const dest = destinations[0];
                    let baseCost = lodgingCosts[dest][lodging];
                    if (lodging === 'hotel' && totalTravelers > 5) baseCost *= Math.ceil(totalTravelers / 5);
                    else if (lodging === 'airbnb') baseCost += (totalTravelers - 1) * 20;
                    lodgingCost = baseCost * days;
                }

                // Meals Cost
                let mealsCost = 0;
                if (meals && destinations.some(dest => ['San Francisco', 'Silicon Valley'].includes(dest))) {
                    mealsCost = totalTravelers * 35 * days;
                }

                // PayPal covers lodging and admission fees
                const paypalAmount = lodgingCost + admissionCost;
                const totalCost = transportCost + airportCost + admissionCost + lodgingCost + mealsCost;

                document.getElementById('transport-cost').textContent = Math.round(transportCost + airportCost);
                document.getElementById('admission-cost').textContent = Math.round(admissionCost);
                document.getElementById('lodging-cost').textContent = Math.round(lodgingCost);
                document.getElementById('meals-cost').textContent = Math.round(mealsCost);
                document.getElementById('total-cost').textContent = Math.round(totalCost);

                // PayPal Button
                paypal.Buttons({
                    createOrder: (data, actions) => {
                        return actions.order.create({
                            purchase_units: [{
                                amount: { value: (paypalAmount / 100).toFixed(2) },
                                payee: { email_address: 'Johnntd21@icloud.com' }
                            }]
                        });
                    },
                    onApprove: (data, actions) => {
                        return actions.order.capture().then(() => {
                            document.getElementById('form-details').value = JSON.stringify({
                                package, destinations, ticketType, adults, kids, travelers: totalTravelers,
                                days, lodging, dropoffAddress, meals, airportPickup, totalCost,
                                paidAmount: paypalAmount
                            });
                            document.getElementById('travel-form').submit();
                        });
                    }
                }).render('#paypal-button');
            } else {
                const type = document.getElementById('airport-service-type').value;
                const address = type === 'pickup' ? document.getElementById('dropoff-address-airport').value : document.getElementById('pickup-address').value;
                const travelers = parseInt(document.getElementById('travelers-airport').value) || 1;

                const transportCost = getAirportCost(address, travelers);

                document.getElementById('transport-cost-airport').textContent = Math.round(transportCost);
                document.getElementById('total-cost-airport').textContent = Math.round(transportCost);

                document.getElementById('form-details-airport').value = JSON.stringify({
                    type, address, travelers, transportCost
                });
            }
        }

        document.getElementById('travel-form').addEventListener('submit', (e) => {
            e.preventDefault();
            fetch('https://formspree.io/f/xeokgbpo', {
                method: 'POST',
                body: new FormData(document.getElementById('travel-form')),
                headers: { 'Accept': 'application/json' }
            }).then(() => {
                window.location.href = 'thankyou.html';
            });
        });

        document.getElementById('airport-form').addEventListener('submit', (e) => {
            e.preventDefault();
            fetch('https://formspree.io/f/xeokgbpo', {
                method: 'POST',
                body: new FormData(document.getElementById('airport-form')),
                headers: { 'Accept': 'application/json' }
            }).then(() => {
                window.location.href = 'thankyou.html';
            });
        });

        // Initialize
        toggleService();
        updateDestinations();
        toggleAirportFields();
    </script>
</body>
</html>
